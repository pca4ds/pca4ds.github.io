x = 2:12
x
px = c(1:6, 5:1) / 36
sum(x * px)
px * ((x - 7)^2)
sum(px * ((x - 7)^2))
sqrt(sum(px * ((x - 7)^2)))
x = 3:7
x
px = c(2, 2, 4, 2, 2)
sum(px)
px = c(2, 2, 4, 2, 2) / 12
sum(x * px)
sum((x-5)^2 * px)
sqrt(sum((x-5)^2 * px))
ls()
rm(list = ls())
# working directory is the top-level directory
cities <- read.csv('data/cities94.csv', stringsAsFactors = FALSE)
cities$city
cities$region
conames(cities)
colnames(cities)
rm(list = ls())
# working directory is the top-level directory
cities94 <- read.csv('data/cities94.csv', stringsAsFactors = FALSE)
cities91 <- read.csv('data/cities91.csv', stringsAsFactors = FALSE)
dim(cities94)
dim(cities91)
# removing missing values
dat94 <- na.omit(cities94[ ,c('city', active)])
# names of active variables
active <- c(
"teacher", "bus_driver", "mechanic", "construction_worker",
"metalworker", "cook_chef", "factory_manager", "engineer",
"bank_clerk", "executive_secretary", "salesperson", "textile_worker")
# removing missing values
dat94 <- na.omit(cities94[ ,c('city', active)])
dat91 <- na.omit(cities91[ ,c('city', active)])
dim(dat94)
dim(dat91)
# PCA
pca <- PCA(dat94[ ,active], graph = FALSE)
# packages
library(FactoMineR)
,
# PCA
pca <- PCA(dat94[ ,active], graph = FALSE)
plot(pca, choix = "ind")
pca_ind <- as.data.frame(pca$ind$coord)
pca_ind$city <- dat$city
head(pca_ind)
# figure 1.9 (first factorial plane)
ggplot(data = pca_ind, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point() +
geom_text(aes(label = city)) +
theme_minimal()
library(ggplot2)
# figure 1.9 (first factorial plane)
ggplot(data = pca_ind, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point() +
geom_text(aes(label = city)) +
theme_minimal()
# figure 1.9 (first factorial plane)
ggplot(data = pca_ind, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point() +
geom_text(aes(label = city)) +
theme_minimal()
pca_ind
# first factorial plane
pca_ind <- as.data.frame(pca$ind$coord)
pca_ind$city <- dat$city
pca_ind$city <- dat94$city
head(pca_ind)
# figure 1.9 (first factorial plane)
ggplot(data = pca_ind, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point() +
geom_text(aes(label = city)) +
theme_minimal()
#
exclude <- c("Manama", "Prague", "Budapest", "AbuDhabi", "Bangkok")
dat94$city %in% exclude
dim(dat94)
pca <- PCA(dat94[!(dat94$city %in% exclude), active], graph = FALSE)
pca_ind <- as.data.frame(pca$ind$coord)
pca_ind$city <- dat94$city
head(pca_ind)
pca <- PCA(dat94[!(dat94$city %in% exclude), active], graph = FALSE)
pca_ind <- as.data.frame(pca$ind$coord)
pca_ind$city <- dat94$city
pca_ind$city <- dat94$city[!(dat94$city %in% exclude)]
head(pca_ind)
# figure 1.9 (first factorial plane)
ggplot(data = pca_ind, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point() +
geom_text(aes(label = city)) +
theme_minimal()
rm(list = ls())
library(FactoMineR)
library(ggplot2)
# working directory is the top-level directory
cities94 <- read.csv('data/cities94.csv', stringsAsFactors = FALSE)
cities91 <- read.csv('data/cities91.csv', stringsAsFactors = FALSE)
# names of active variables
active <- c(
"teacher", "bus_driver", "mechanic", "construction_worker",
"metalworker", "cook_chef", "factory_manager", "engineer",
"bank_clerk", "executive_secretary", "salesperson", "textile_worker")
# removing missing values
dat2 <- na.omit(
cities[ ,c('city', 'net_hourly_salary', 'work_hours_year', active)]
)
# ========================================================
# 2.3) Beyond the first factor
# ========================================================
# mean salary as product of 'net_hourly_salary' x 'work_hours_year'
mean_salary <- dat2[ ,2] * dat2[ ,3]
# transformed data
dat_trans <- sweep(dat2[ ,active], 1, mean_salary, FUN = "/")
colnames(dat_trans) <- paste(active, '2', sep='')
# cities to be excluded
to_exclude <- c("Manama", "Prague", "Budapest", "AbuDhabi", "Bangkok")
# PCA of Transformed Data
pca2 <- PCA(dat_trans, graph = FALSE)
# removing missing values
dat2 <- na.omit(
cities94[ ,c('city', 'net_hourly_salary', 'work_hours_year', active)]
)
# mean salary as product of 'net_hourly_salary' x 'work_hours_year'
mean_salary <- dat2[ ,2] * dat2[ ,3]
# transformed data
dat_trans <- sweep(dat2[ ,active], 1, mean_salary, FUN = "/")
colnames(dat_trans) <- paste(active, '2', sep='')
# cities to be excluded
to_exclude <- c("Manama", "Prague", "Budapest", "AbuDhabi", "Bangkok")
# PCA of Transformed Data
pca2 <- PCA(dat_trans, graph = FALSE)
dat91 <- cities91[ ,c('city', active)]
dat91$city
summary(dat91[,-1])
which(is.na(dat91$teacher))
which(is.na(dat91$bus_driver))
which(is.na(dat91$bus_driver))
dat91$city[7]
pca2$svd
pca2$svd$V[ ,1:2]
dat91$city
summary(dat91[1:5, ])
dat91[1:5, ] %*% pca2$svd$V[ ,1:2]
dat91[1:5,active] %*% pca2$svd$V[ ,1:2]
class(dat91[1:5,active])
as.matrix(dat91[1:5,active]) %*% pca2$svd$V[ ,1:2]
head(dat_trans)
dat91_trans <- sweep(dat91[1:5,active], 1, mean_salary, FUN = "/")
mean_salary
dat2$city[1:5]
dat2$city[1:6]
dat91$city[1:5]
dat2$city[1:8]
dat91$city[1:5]
dat91_trans <- sweep(dat91[1:5,active], 1, mean_salary[c(2:3,5:7)], FUN = "/")
dat91_trans
as.matrix(dat91_trans) %*% pca2$svd$V[ ,1:2]
# first factorial plane
pca_ind <- as.data.frame(pca$ind$coord[ ,1:2])
# PCA of Transformed Data
pca2 <- PCA(dat_trans, graph = FALSE)
# first factorial plane
pca_ind <- as.data.frame(pca2$ind$coord[ ,1:2])
pca_ind$city <- dat94$city[!(dat94$city %in% exclude)]
# first factorial plane
pca_ind <- as.data.frame(pca2$ind$coord[ ,1:2])
pca_ind$city <- dat2$city[!(dat94$city %in% exclude)]
# first factorial plane
pca_ind <- as.data.frame(pca2$ind$coord[ ,1:2])
pca_ind$city <- dat2$city
as.matrix(dat91_trans) %*% pca2$svd$V[ ,1:2]
# Cities 1991
dat91_trans <- sweep(dat91[1:5,active], 1, mean_salary[c(2:3,5:7)], FUN = "/")
more <- as.data.frame(as.matrix(dat91_trans) %*% pca2$svd$V[ ,1:2])
more$city <- dat91$city[1:5]
more
# first factorial plane
pca_ind <- as.data.frame(pca2$ind$coord[ ,1:2])
pca_ind$city <- dat2$city
pca_ind
pca_ind$year <- 1994
more$year <- 1991
rbind.data.frame(pca_ind, more)
colnames(more) <- c("Dim.1", "Dim.2", "city", "year")
rbind.data.frame(pca_ind, more)
dat <- rbind.data.frame(pca_ind, more)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city)) +
theme_minimal()
dat$year <- as.factor(dat$year)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city)) +
theme_minimal()
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city, color = year)) +
theme_minimal()
# cities to be excluded
to_exclude <- c("Manama", "Prague", "Budapest", "AbuDhabi", "Bangkok")
pca_ind$city %in% to_exclude
pca_ind <- pca_ind[!(pca_ind$city %in% to_exclude), ]
pca_ind
dat <- rbind.data.frame(pca_ind, more)
dat$year <- as.factor(dat$year)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city, color = year)) +
theme_minimal()
cbind(
dat2$city[!(pca_ind$city %in% to_exclude)],
mean_salary[!(pca_ind$city %in% to_exclude)]
)
head(dat91)
# cities to be excluded
to_include <- !(pca_ind$city %in% to_exclude)
to_include
pca_ind$city
!(dat2$city %in% to_exclude)
to_include
to_exclude <- c("Manama", "Prague", "Budapest", "AbuDhabi", "Bangkok")
to_include <- !(dat2$city %in% to_exclude)
to_include
sweep(dat91[ ,active], 1, mean_salary[to_include], FUN = "/")
sum(to_include)
dim(dat91)
dat2$city
dim(91)
dim(dat91)
dim(cities91)
dim(cities94)
# working directory is the top-level directory
cities94 <- read.csv('data/cities94.csv', stringsAsFactors = FALSE)
cities91 <- read.csv('data/cities91.csv', stringsAsFactors = FALSE)
# names of active variables
active <- c(
"teacher", "bus_driver", "mechanic", "construction_worker",
"metalworker", "cook_chef", "factory_manager", "engineer",
"bank_clerk", "executive_secretary", "salesperson", "textile_worker")
# removing missing values
dat2 <- na.omit(
cities94[ ,c('city', 'net_hourly_salary', 'work_hours_year', active)]
)
dim(cities94)
dim(dat2)
cities94$city %in% dat2$city
cities94$city[!(cities94$city %in% dat2$city)]
dat91 <- cities91[ ,c('city', active)]
to_exclude <- c("Manama", "Prague", "Budapest", "AbuDhabi",
"Bangkok", "Cairo", "KualaLumpur")
to_include <- !(dat2$city %in% to_exclude)
rm(list = ls())
# working directory is the top-level directory
cities94 <- read.csv('data/cities94.csv', stringsAsFactors = FALSE)
cities91 <- read.csv('data/cities91.csv', stringsAsFactors = FALSE)
# names of active variables
active <- c(
"teacher", "bus_driver", "mechanic", "construction_worker",
"metalworker", "cook_chef", "factory_manager", "engineer",
"bank_clerk", "executive_secretary", "salesperson", "textile_worker")
# removing missing values
dat2 <- na.omit(
cities94[ ,c('city', 'net_hourly_salary', 'work_hours_year', active)]
)
dat91 <- cities91[ ,c('city', active)]
to_exclude <- c("Manama", "Prague", "Budapest", "AbuDhabi",
"Bangkok", "Cairo", "KualaLumpur")
to_include <- !(dat2$city %in% to_exclude)
# mean salary as product of 'net_hourly_salary' x 'work_hours_year'
mean_salary <- dat2[ ,2] * dat2[ ,3]
# transformed data
dat_trans <- sweep(dat2[ ,active], 1, mean_salary, FUN = "/")
colnames(dat_trans) <- paste(active, '2', sep='')
# PCA of Transformed Data
pca2 <- PCA(dat_trans, graph = FALSE)
# first factorial plane
pca_ind <- as.data.frame(pca2$ind$coord[ ,1:2])
pca_ind$city <- dat2$city
pca_ind$year <- 1994
pca_ind <- pca_ind[!(pca_ind$city %in% to_exclude), ]
sweep(dat91[ ,active], 1, mean_salary[to_include], FUN = "/")
sum(to_include)
dim(dat_trans)
dim(dat91)
dim(dat2)
# working directory is the top-level directory
cities94 <- read.csv('data/cities94.csv', stringsAsFactors = FALSE)
cities91 <- read.csv('data/cities91.csv', stringsAsFactors = FALSE)
# names of active variables
active <- c(
"teacher", "bus_driver", "mechanic", "construction_worker",
"metalworker", "cook_chef", "factory_manager", "engineer",
"bank_clerk", "executive_secretary", "salesperson", "textile_worker")
# removing missing values
dat2 <- na.omit(
cities94[ ,c('city', 'net_hourly_salary', 'work_hours_year', active)]
)
dim(cities94)
dim(dat2)
# mean salary as product of 'net_hourly_salary' x 'work_hours_year'
mean_salary <- dat2[ ,2] * dat2[ ,3]
# transformed data
dat_trans <- sweep(dat2[ ,active], 1, mean_salary, FUN = "/")
colnames(dat_trans) <- paste(active, '2', sep='')
dim(dat_trans)
dat2$city
dim(dat91)
dim(cities91)
dim(cities94)
rm(list = ls())
# packages
library(FactoMineR)
library(ggplot2)
# working directory is the top-level directory
cities94 <- read.csv('data/cities94.csv', stringsAsFactors = FALSE)
cities91 <- read.csv('data/cities91.csv', stringsAsFactors = FALSE)
# names of active variables
active <- c(
"teacher", "bus_driver", "mechanic", "construction_worker",
"metalworker", "cook_chef", "factory_manager", "engineer",
"bank_clerk", "executive_secretary", "salesperson", "textile_worker")
# removing missing values
dat2 <- na.omit(
cities94[ ,c('city', 'net_hourly_salary', 'work_hours_year', active)]
)
dat91 <- cities91[ ,c('city', active)]
to_exclude <- c("Manama", "Prague", "Budapest", "AbuDhabi", "Bangkok")
#"Bangkok", "Cairo", "KualaLumpur")
to_include <- !(dat2$city %in% to_exclude)
# mean salary as product of 'net_hourly_salary' x 'work_hours_year'
mean_salary <- dat2[ ,2] * dat2[ ,3]
# transformed data
dat_trans <- sweep(dat2[ ,active], 1, mean_salary, FUN = "/")
colnames(dat_trans) <- paste(active, '2', sep='')
# PCA of Transformed Data
pca2 <- PCA(dat_trans, graph = FALSE)
# first factorial plane
pca_ind <- as.data.frame(pca2$ind$coord[ ,1:2])
pca_ind$city <- dat2$city
pca_ind$year <- 1994
pca_ind <- pca_ind[!(pca_ind$city %in% to_exclude), ]
# Cities 1991
dat91_trans <- sweep(dat91[ ,active], 1, mean_salary[to_include], FUN = "/")
dim(dat91)
sum(to_include)
to_exclude <- c("Manama", "Prague", "Budapest", "AbuDhabi", "Bangkok")
#"Bangkok", "Cairo", "KualaLumpur")
to_include <- !(cities94$city %in% to_exclude)
sweep(dat91[ ,active], 1, mean_salary[to_include], FUN = "/")
# Cities 1991
dat91_trans <- sweep(dat91[ ,active], 1, mean_salary[to_include], FUN = "/")
more <- as.data.frame(as.matrix(dat91_trans) %*% pca2$svd$V[ ,1:2])
more$city <- dat91$city[1:5]
# Cities 1991
dat91_trans <- sweep(dat91[ ,active], 1, mean_salary[to_include], FUN = "/")
more <- as.data.frame(as.matrix(dat91_trans) %*% pca2$svd$V[ ,1:2])
more$city <- dat91$city
more$year <- 1991
colnames(more) <- c("Dim.1", "Dim.2", "city", "year")
dat <- rbind.data.frame(pca_ind, more)
dat$year <- as.factor(dat$year)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city, color = year)) +
theme_minimal()
colMeans(dat_trans)
# Cities 1991
dat91_trans <- sweep(dat91[ ,active], 1, mean_salary[to_include], FUN = "/")
dat91_supp <- sweep(dat91_trans, 2, colMeans(dat_trans), "-")
dat91_supp <- sweep(dat91_supp, 2, apply(dat_trans, 2, sd), "/")
more <- as.data.frame(as.matrix(dat91_trans) %*% pca2$svd$V[ ,1:2])
more$city <- dat91$city
more$year <- 1991
colnames(more) <- c("Dim.1", "Dim.2", "city", "year")
dat <- rbind.data.frame(pca_ind, more)
dat$year <- as.factor(dat$year)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city, color = year)) +
theme_minimal()
dat91_supp
more <- as.data.frame(as.matrix(dat91_supp) %*% pca2$svd$V[ ,1:2])
more$city <- dat91$city
more$year <- 1991
colnames(more) <- c("Dim.1", "Dim.2", "city", "year")
dat <- rbind.data.frame(pca_ind, more)
dat$year <- as.factor(dat$year)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city, color = year)) +
theme_minimal()
pca2$svd$V[ ,1:2] %*% diag(pca2$svd$vs)
pca2$svd$V[ ,1:2]
pca2$svd$vs
diag(pca2$svd$vs) %*% pca2$svd$V[ ,1:2]
more <- as.data.frame(as.matrix(dat91_supp) %*% diag(pca2$svd$vs) %*% pca2$svd$V[ ,1:2])
more$city <- dat91$city
more$year <- 1991
colnames(more) <- c("Dim.1", "Dim.2", "city", "year")
dat <- rbind.data.frame(pca_ind, more)
dat$year <- as.factor(dat$year)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city, color = year)) +
theme_minimal()
pca2$svd$vs
1/pca2$svd$vs
more <- as.data.frame(as.matrix(dat91_supp) %*% diag(1/pca2$svd$vs) %*% pca2$svd$V[ ,1:2])
more$city <- dat91$city
more$year <- 1991
colnames(more) <- c("Dim.1", "Dim.2", "city", "year")
dat <- rbind.data.frame(pca_ind, more)
dat$year <- as.factor(dat$year)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city, color = year)) +
theme_minimal()
# Cities 1991
#dat91_trans <- sweep(dat91[ ,active], 1, mean_salary[to_include], FUN = "/")
dat91_trans <- dat91[ ,active]
dat91_supp <- sweep(dat91_trans, 2, colMeans(dat_trans), "-")
dat91_supp <- sweep(dat91_supp, 2, apply(dat_trans, 2, sd), "/")
more <- as.data.frame(as.matrix(dat91_supp) %*% pca2$svd$V[ ,1:2])
more$city <- dat91$city
more$year <- 1991
colnames(more) <- c("Dim.1", "Dim.2", "city", "year")
dat <- rbind.data.frame(pca_ind, more)
dat$year <- as.factor(dat$year)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city, color = year)) +
theme_minimal()
more <- as.data.frame(as.matrix(dat91_supp) %*% diag(1/pca2$svd$vs) %*% pca2$svd$V[ ,1:2])
more$city <- dat91$city
more$year <- 1991
colnames(more) <- c("Dim.1", "Dim.2", "city", "year")
dat <- rbind.data.frame(pca_ind, more)
dat$year <- as.factor(dat$year)
# figure 1.9 (first factorial plane)
ggplot(data = dat, aes(x = Dim.1, y = Dim.2)) +
geom_vline(xintercept = 0, color = 'gray60') +
geom_hline(yintercept = 0, color = 'gray60') +
geom_point(aes(color = year)) +
geom_text(aes(label = city, color = year)) +
theme_minimal()
